#!/usr/bin/env sh

CURRENT_BRANCH=$(git branch --show-current)
if [[ "$CURRENT_BRANCH" == "main" ]]; then
  . "$(dirname "$0")/_/husky.sh"
  echo "ğŸ”’ Pushing to main branch detected!"
  echo "ğŸ§ª Running full test suite..."
  ./gradlew testAll

  if [ $? -eq 0 ]; then
    echo "âœ… All tests passed! Push proceeding..."
  else
    echo "âŒ Tests failed! Push blocked."
    exit 1
  fi
else
  echo "ğŸŒ¿ On branch: $CURRENT_BRANCH"
  echo "â­ï¸  Skipping tests for non-main branch"
fi


